<div class="uk-container">

    <div class="uk-grid" uk-grid>
        <div class="uk-width-2-3@m uk-width-1-1">
            <!-- PROFILE -->
            <div class="profile-card-wrapper">
                <div class="uk-card uk-card-default">
                    <div class="uk-card-header">
                        <div class="uk-grid-small uk-flex-middle" uk-grid>
                            <div class="uk-width-auto">
                                <img class="uk-border-circle" width="40" height="40" src="{{ ( attribute(user, 'photo') is defined and user.photo ) ? asset(uploaded_asset(user.photoPath))|imagine_filter('squared_thumbnail_small') : asset('build/images/avatar.png') }}">
                            </div>
                            <div class="uk-width-expand">
                                <a href="{{ path('profile_index', {'id': user.id}) }}">
                                    <h3 class="uk-card-title uk-margin-remove-bottom">{{ user.getFullName }}</h3>
                                </a>
                                <p class="uk-text-meta uk-margin-remove-top">
                                    {% if user.company is defined and user.company is not null %}
                                        <span><a href="{{ path('company_view', {'id': user.company.id}) }}">{{ user.company.name }}</a></span>
                                    {% else %}
                                        <span>Professional</span>
                                    {% endif %}

                                    {% if user.primaryIndustry is defined %}
                                        <span>- {{ user.primaryIndustry.name }}</span>
                                    {% endif %}
                                    {% if user.secondaryIndustries|length > 0 %}
                                        <span>- {{ user.secondaryIndustries[0].name }}</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="uk-width-auto">
                                <div class="uk-align-right">
                                    <a href="{{ path('profile_edit', {'id': user.id}) }}">
                                        <span class="uk-margin-small-right" uk-icon="icon: file-edit; ratio: 1"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="uk-card-body">
                        {% if user.briefBio %}
                            <div class="uk-margin">
                                {{ user.briefBio|raw }}
                            </div>
                        {% else %}
                            <p>Welcome to {{ get_site().name }}! <a href="{{ path('profile_edit', {'id': user.id}) }}">Add a brief bio</a> to let everyone know your strengths!</p>
                        {% endif %}
                        <div class="professional-links">
                            {% if user.emailAfterPrivacySettingsApplied %}
                                <a href="mailto:{{ user.emailAfterPrivacySettingsApplied }}" class="uk-icon-button uk-margin-small-right" uk-icon="mail"></a>
                            {% endif %}
                            {% if user.phoneAfterPrivacySettingsApplied %}
                                <a href="tel:{{ user.phoneAfterPrivacySettingsApplied }}" class="uk-icon-button uk-margin-small-right" uk-icon="receiver"></a>
                            {% endif %}
                            {% if user.getLinkedinProfile %}
                                <a href="{{ user.linkedinProfile }}" class="uk-icon-button uk-margin-small-right" uk-icon="linkedin" target="_blank"></a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="uk-margin">
                <ul class="uk-tab" uk-switcher="connect: #tab-user-preferences" uk-tab>
                    <li class="uk-active"><a href="#user-preferences">Calendar</a></li>
                    <li><a href="#user-schools">My Schools</a></li>
                    <li><a href="#user-lessons">My Lessons</a></li>
                    <li><a href="#user-feedback">My Feedback</a></li>
                </ul>
                <div class="uk-switcher" id="tab-user-preferences">
                    <div class="user_preferences_calendar">
                        <div class="react-events-calendar" data-user-id="{{ user.id }}"></div>
                    </div>
                    <div class="user_preferences_schools">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid-small uk-flex-middle" uk-grid>
                                    <div class="uk-width-auto">
                                        <i class="fa fa-graduation-cap" aria-hidden="true"></i>
                                    </div>
                                    <div class="uk-width-expand">
                                        <h3 class="uk-card-title uk-margin-remove-bottom">Schools I Volunteer At</h3>
                                    </div>
                                    <div class="uk-width-auto">
                                        <div class="uk-align-right">
                                            <a href="{{ path('profile_edit', {'id': user.id}) }}">
                                                <span class="uk-margin-small-right" uk-icon="icon: file-edit; ratio: 1"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                {% if user.schools is defined and user.schools|length > 0 %}
                                    <ul class="uk-list uk-list-divider">
                                        {% for school in user.schools %}
                                            <li>{{ school.name }}</li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    <p>You haven't added any schools yet.</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="user_preferences_lessons">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid-small uk-flex-middle" uk-grid>
                                    <div class="uk-width-auto">
                                        <i class="fa fa-book" aria-hidden="true"></i>
                                    </div>
                                    <div class="uk-width-expand">
                                        <h3 class="uk-card-title uk-margin-remove-bottom">Lessons I Can Teach</h3>
                                    </div>
                                    <div class="uk-width-auto">
                                        <div class="uk-align-right">
                                            <a href="{{ path('lesson_index') }}">
                                                <span class="uk-margin-small-right" uk-icon="icon: file-edit; ratio: 1"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                {% if user.lessonTeachables|length > 0 %}
                                    <ul class="uk-list uk-list-divider">
                                        {% for teachable in user.lessonTeachables %}
                                            <li><a class="uk-link-text" href="{{ path('lesson_view', {'id': teachable.lesson.id}) }}">{{ teachable.lesson.title }}</a></li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    <p>You haven't added any lessons yet.</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="user_preferences_feedback">
                        {% if dashboards.completedTeachLessonExperiences|length > 0 %}
                            <div uk-grid>
                                <div class="uk-width-1-1 uk-width-small@m">
                                    <ul class="uk-tab-left" uk-tab="connect: #tab-account-inner; animation: uk-animation-fade">
                                        {% for experience in dashboards.completedTeachLessonExperiences %}
                                            <li><a href="#feedback-{{ experience.id }}">{{ experience.startDateAndTime|date("m/d/Y") }}</a></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div class="uk-width-1-1 uk-width-expand@m">
                                    <ul id="tab-account-inner" class="uk-switcher">
                                        {% for experience in dashboards.completedTeachLessonExperiences %}
                                            <div class="feedback-{{ experience.id }}">
                                                <strong>Feedback for {{ experience.title }}</strong>
                                                {% if experience.feedback|length > 0 %}
                                                    <div class="uk-overflow-auto">
                                                        <table class="uk-table uk-table-divider">
                                                            <thead>
                                                            <tr>
                                                                <th>Role</th>
                                                                <th>Rating</th>
                                                                <th>Insight</th>
                                                                <th>Enjoyable</th>
                                                                <th>Learned</th>
                                                                <th>Recommendation</th>
                                                                <th>Feedback</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            {% for feedback in experience.feedback %}
                                                                <tr>
                                                                    <td class="uk-text-nowrap">{{ feedback.user.educator ? "Educator" : "Student" }}</td>
                                                                    <td class="uk-text-nowrap">{{ feedback.rating }}</td>
                                                                    <td class="uk-text-nowrap">{{ feedback.providedCareerInsight == 1 ? "YES" : "NO" }}</td>
                                                                    <td class="uk-text-nowrap">{{ feedback.wasEnjoyableAndEngaging == 1 ? "YES" : "NO" }}</td>
                                                                    <td class="uk-text-nowrap">{{ feedback.learnSomethingNew == 1 ? "YES" : "NO" }}</td>
                                                                    <td class="uk-text-nowrap">{{ feedback.likelihoodToRecommendToFriend }}</td>
                                                                    <td>{{ feedback.additionalFeedback }}</td>
                                                                </tr>
                                                            {% endfor %}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                {% else %}
                                                    <p>No feedback has been submitted yet.</p>
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="uk-width-1-3@m uk-width-1-1">

            <!-- Quick Links -->
            <div class="quick-links-wrapper uk-margin">
                <div class="uk-card uk-card-default">
                    <div class="uk-card-header">
                        <div class="uk-grid-small uk-flex-middle" uk-grid>
                            <div class="uk-width-expand">
                                <h3 class="uk-card-title uk-margin-remove-bottom">My volunteer roles</h3>
                            </div>
                            <div class="uk-width-auto">
                                <div class="uk-align-right">
                                    <a href="{{ path('profile_edit', {'id': user.id}) }}">
                                        <span class="uk-margin-small-right" uk-icon="icon: file-edit; ratio: 1"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="uk-card-body">
                        {% if user.rolesWillingToFulfill|length %}
                            <ul class="uk-list uk-list-divider">
                                {% for role in user.rolesWillingToFulfill %}
                                    <li>{{ role.name }}</li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p>You haven't added any roles yet.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            <!-- My Company -->
            <div class="quick-links-wrapper uk-margin">
                <div class="uk-card uk-card-default">
                    <div class="uk-card-header">
                        <div class="uk-grid-small uk-flex-middle" uk-grid>
                            <div class="uk-width-expand">
                                <h3 class="uk-card-title uk-margin-remove-bottom">My Company</h3>
                            </div>
                        </div>
                    </div>
                    <div class="uk-card-body">
                        {% if user.company is defined and user.company %}
                            <a href="{{ path('company_view', { id: user.company.id }) }}"><h4>{{ user.company.name }}</h4></a>
                            <h5>Upcoming Events</h5>
                            {% set noEventsFound = true %}
                            {% if user.company.companyExperiences|length > 0 %}
                                <ul class="uk-list uk-list-divider uk-margin-remove-top uk-margin-remove-bottom">
                                    {% for experience in user.company.companyExperiences %}
                                        {% if date(experience.startDateAndTime) > date() %}
                                            {% set noEventsFound = false %}
                                            <li><a class="uk-text-meta" href="{{ path('company_experience_view', {id: experience.id}) }}">{{ experience.startDateAndTime|date("F jS") }} - {{ experience.title }}</a></li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            {% endif %}

                            {% if noEventsFound == true %}
                                <p class="uk-text-meta">There are no upcoming events at this time</p>
                            {% endif %}

                            {% if user.isAdmin or user.id == user.company.owner.id %}
                                <a href="{{ path('company_experience_create', { id: user.company.id }) }}" class="uk-button uk-button-primary uk-button-small uk-inline">Create an Experience</a>
                            {% endif %}
                        {% else %}
                            <div className="uk-placeholder uk-text-center">
                                <p>You aren't associated with a company yet.</p>
                                <a href="{{ path('company_index') }}" class="uk-button uk-button-default uk-button-small uk-inline uk-margin-small-right">Join a Company</a>
                                <a href="{{ path('company_new') }}" class="uk-button uk-button-primary uk-button-small uk-inline">Create</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
