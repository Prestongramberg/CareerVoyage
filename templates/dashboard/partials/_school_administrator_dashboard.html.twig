<div class="uk-container">

    <div class="uk-grid" uk-grid>
        <div class="uk-width-1-1">
            <!-- PROFILE -->
            <div class="profile-card-wrapper">
                <div class="uk-card uk-card-default">
                    <div class="uk-card-header">
                        <div class="uk-grid-small uk-flex-middle" uk-grid>
                            <div class="uk-width-auto">
                                <img class="uk-border-circle" width="40" height="40"
                                     src="{{ ( attribute(user, 'photo') is defined and user.photo ) ? asset(uploaded_asset(user.photoPath))|imagine_filter('squared_thumbnail_small') : asset('build/images/avatar.png') }}">
                            </div>
                            <div class="uk-width-expand">
                                <h3 class="uk-card-title uk-margin-remove-bottom">{{ user.getFullName }}</h3>
                                <p class="uk-text-meta uk-margin-remove-top">
                                    School Administrator
                                </p>
                            </div>
                            <div class="uk-width-auto">
                                <div class="uk-align-right">
                                    <a href="{{ path('profile_edit', {'id': user.id}) }}">
                                        <span class="uk-margin-small-right" uk-icon="icon: file-edit; ratio: 1"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="uk-container uk-margin">
    <div class="uk-margin uk-grid" uk-grid>
        <div class="uk-width-1-1">
            <select id="js-school-administrator-schools" class="uk-select" style="float: left; width: 300px">
                {% for school in user.schools %}
                    <option {{ school.id == schoolId or loop.index == 1 ? 'selected' : '' }}
                            value="{{ path('dashboard') }}?school={{ school.id }}">{{ school.name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
</div>

<div class="uk-container uk-margin">

    {% if schoolId %}
        {% set schools = user.schools|filter(s => s.id == schoolId) %}
    {% else %}
        {% set schools = user.schools|filter((v, k) => k == 0) %}
    {% endif %}

    {% for school in schools %}

        <div class="school_{{ school.id }}">
            <div class="uk-grid" uk-grid>
                <div class="uk-width-1-1 uk-width-2-3@l">
                    <div class="uk-panel">
                        <div class="school_description">
                            <div class="uk-section uk-section-muted uk-padding-large">
                                <div class="uk-container">
                                    <h2>{{ school.name }} Overview</h2>
                                    {% if school.overviewAndBackground %}
                                        {{ school.overviewAndBackground|raw }}
                                    {% else %}
                                        <p>This school does not have an overview added yet.</p>
                                    {% endif %}
                                    <p><a class="uk-link"
                                          href="{{ path('school_edit', {'id': school.id}) }}">Edit</a></p>
                                </div>
                            </div>
                        </div>
                    </div>


                    <br>
                    <br>

                    <div class="uk-child-width-1-2@s uk-grid-match" uk-grid>
                      {#  <div>
                            <div class="uk-card uk-card-hover uk-card-body">
                                <h3 class="uk-card-title">Hover</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
                            </div>
                        </div>
                        <div>
                            <div class="uk-card uk-card-default uk-card-hover uk-card-body">
                                <h3 class="uk-card-title">Manage Experiences</h3>
                                <p>Create Experience</p>
                                <p>Manage experiences</p>
                            </div>
                        </div>#}
                        <div>
                            <div class="uk-card uk-card-primary uk-card-hover uk-card-body uk-light uk-text-center">
                                <h3 class="uk-card-title">Create an Experience</h3>
                                <p>Create engaging school events that other user's can search and register for.</p>
                                <a class="uk-button uk-button-default" target="_blank" href="{{ path('experience_new') }}?schoolId={{ school.id }}">Get Started</a>
                            </div>
                        </div>
                        <div>
                            <div class="uk-card uk-card-secondary uk-card-hover uk-card-body uk-light uk-text-center">
                                <h3 class="uk-card-title">Manage Students</h3>
                                <p>Reset passwords, change supervising teachers, import students, and more.</p>
                                <a class="uk-button uk-button-default" target="_blank" href="{{ path('students_manage', {id: school.id}) }}">Get Started</a>
                            </div>
                        </div>
                    </div>

                    <br>
                    <br>

                    {% if school.isUserSchoolAdministrator(user) %}
                        <div class="uk-margin">
                            <ul class="uk-tab school-tab-tools"
                                uk-switcher="connect: #tab-school-{{ school.id }}-tools" uk-tab>
                                <li class="uk-active"><a href="?school={{ school.id }}&tool=calendar">My
                                        Calendar</a></li>
                                {# <li class="uk-visible@m"><a href="?school={{school.id}}&tool=participation">Participation</a></li> #}
                                <li><a href="?school={{ school.id }}&tool=educators">Educators</a></li>
                                <li><a href="?school={{ school.id }}&tool=experiences">Experiences</a></li>
                                <li><a href="?school={{ school.id }}&tool=feedback">Feedback</a></li>
                            </ul>
                            <div class="uk-switcher" id="tab-school-{{ school.id }}-tools">
                                <div class="school_{{ school.id }}_tools_calendar">
                                    <div class="react-events-embed" data-school-id="{{ school.id }}"></div>
                                </div>
                                {# <div class="school_{{ school.id }}_tools_participation uk-visible@m">
                                        <div class="uk-card uk-card-default">
                                            <div class="uk-card-body">
                                                <h3>Company Experiences in {{ "now"|date("F, Y") }} by Industry</h3>
                                                <div class="react-horizontal-bar-chart" data-sets='[{"label": "Company Experiences", "data": [5,8,3,7,12,9,11,9,3,5,8,5,6,9,11,9]},{"label": "Educator Sign Ups", "data": [2,12,4,9,6,4,11,3,6,7,9,2,1,8,4,6]}]' data-labels='["Agriculture, Food &amp; Natural Resources", "Architecture &amp; Construction", "Arts, A/V Technology &amp; Communications", "Business Management &amp; Administration", "Education &amp; Training", "Finance", "Government &amp; Public Administration", "Health Science", "Hospitality &amp; Tourism", "Human Services", "Information Technology", "Law, Public Safety, Corrections &amp; Security", "Manufacturing", "Marketing", "Science, Technology, Engineering &amp; Mathematics", "Transportation, Distribution &amp; Logistics"]'></div>
                                            </div>
                                        </div>
                                    </div> #}
                                <div class="school_{{ school.id }}_tools_educators">

                                    <div class="uk-margin uk-width-1-1">
                                        <div class="uk-flex uk-flex-right@m">
                                            <a href="{{ path('school_educator_import', { "id": school.id }) }}"
                                               class="uk-button uk-button-primary uk-button-small">Add
                                                Educators</a>
                                        </div>
                                    </div>

                                    {% if school.educatorUsers|length %}
                                        <div class="school__educators">
                                            <dl class="uk-description-list uk-description-list-divider">
                                                <iframe src="{{ path('educator_manage', {id: school.id}) }}"
                                                        style="border:none;" width="100%"
                                                        height="800px"></iframe>
                                            </dl>
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="school_{{ school.id }}_tools_experiences">
                                    {% if school.sortedSchoolExperiences|length %}
                                        <div class="school__educators">
                                            <dl class="uk-description-list uk-description-list-divider">
                                                {% for experience in school.sortedSchoolExperiences %}

                                                    {% set experienceId = experience.id %}

                                                    {% if experience.cancelled != 1 %}
                                                        <div class="uk-grid uk-flex-middle" uk-grid>
                                                            <div class="uk-width-expand">
                                                                <dt>{{ experience.title }}</dt>
                                                            </div>
                                                            <div class="uk-width-1-1 uk-width-auto@m">
                                                                <a target="_blank" href="{{ path('experience_view', { "id": experience.id }) }}"
                                                                   class="uk-button uk-button-default uk-button-small">View</a>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            </dl>
                                        </div>
                                    {% endif %}

                                </div>
                                <div class="school_{{ school.id }}_tools_feedback">
                                    {# FEEDBACK WIDGET #}
                                    {{ feedback_widget(user, null, school)|raw }}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
                <div class="uk-width-1-1 uk-width-1-3@l">
                    <div class="quick-links-wrapper">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid-small uk-flex-middle" uk-grid>
                                    <div class="uk-width-expand">
                                        <h3 class="uk-card-title uk-margin-remove-bottom">Feedback</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                <ul class="uk-list">

                                    <a href="{{ path('feedback_view_all') }}" target="_blank">View All Relevant
                                        Feedback</a>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Start New Topics -->
                    <div class="quick-links-wrapper uk-margin">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid-small uk-flex-middle" uk-grid>
                                    <div class="uk-width-expand">
                                        <h3 class="uk-card-title uk-margin-remove-bottom">New Topics</h3>
                                    </div>
                                    <div class="uk-width-auto">
                                        <div class="uk-align-right">
                                            <a href="{{ path('lesson_new') }}">
                                            <span class="uk-margin-small-right"
                                                  uk-icon="icon: plus; ratio: 1"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                <div style="text-align: left">
                                    {{ render(controller('App\\Controller\\DashboardController::topics')) }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End New Topics -->

                    <!-- Start New Experiences -->
                    <div class="quick-links-wrapper uk-margin">
                        <div class="uk-card uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid-small uk-flex-middle" uk-grid>
                                    <div class="uk-width-expand">
                                        <h3 class="uk-card-title uk-margin-remove-bottom">New Experiences</h3>
                                    </div>
                                    <div class="uk-width-auto">
                                        <div class="uk-align-right">
                                            <a target="_blank" href="{{ path('experience_new', { schoolId: school.id }) }}">
                                            <span class="uk-margin-small-right"
                                                  uk-icon="icon: plus; ratio: 1"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                {{ render(controller('App\\Controller\\DashboardController::experiences')) }}
                            </div>
                        </div>
                    </div>
                    <!-- End New Experiences -->

                </div>


            </div>
        </div>

    {% endfor %}
</div>
