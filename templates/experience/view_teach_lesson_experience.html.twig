{% extends 'baseAuthenticated.html.twig' %}

{% block title %}Teach Lesson Experience{% endblock %}
{% block bodyClass %}page-teach-lesson-experience{% endblock %}

{% block body %}

    <div class="uk-container">

        <div class="uk-section uk-section-muted">
            <div class="uk-padding">
                <h2 class="uk-margin-remove-bottom">{{ experience.school.name }}</h2>
                <h3 class="uk-margin-remove-top">{{ experience.title }}</h3>
                <h5>{{ experience.startDateAndTime|date("F jS \\a\\t g:ia") }}</h5>
                {{ experience.about|raw }}
            </div>

            {% if user.educator %}
                <a style="margin-left: 25px" class="uk-button uk-button-danger uk-button-small" href="#modal-remove-company-event" uk-toggle>Live Feedback URL</a>
                <br>
                <div id="modal-remove-company-event" uk-modal>
                    <div class="uk-modal-dialog uk-modal-body">

                        <h3>Live Feedback URL</h3>
                        <p>{{ url('experience_feedback', {'id' : experience.id}) }}</p>
                        <input style="display: none" id="feedback-url" type="text" value="{{ url('experience_feedback', {'id' : experience.id}) }}">

                        <button class="uk-button uk-button-danger" onclick="copyFeedbackUrl()" type="button">Copy</button>

                    </div>
                </div>
            {% endif %}
        </div>

        <ul class="uk-tab" uk-switcher="connect: #tab-experience" uk-tab>
            <li class="uk-active"><a href="#experience-details">Experience</a></li>
            <li><a href="#experience-contact">Contact</a></li>
        </ul>
        <div class="uk-switcher" id="tab-experience">
            <div class="experience_details">
                <table class="uk-table uk-table-justify uk-table-divider">
                    <tbody>
                        <tr>
                            <td>Title</td>
                            <td>{{ experience.title }}</td>
                        </tr>
                        <tr>
                            <td>School</td>
                            <td>{{ experience.school.name }}</td>
                        </tr>
                        <tr>
                            <td>Description</td>
                            <td>{{ experience.briefDescription }}</td>
                        </tr>
                        <tr>
                            <td>Start Time</td>
                            <td>{{ experience.startDateAndTime|date("F jS \\a\\t g:ia") }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="experience_contact">
                <table class="uk-table uk-table-justify uk-table-divider">
                    <tbody>
                    <tr>
                        <td>Name</td>
                        {% if experience.originalRequest.isFromProfessional %}
                            <td>{{ experience.originalRequest.needsApprovalBy.fullName }}</td>
                        {% else %}
                            <td>{{ experience.originalRequest.createdBy.fullName }}</td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td>Address</td>
                        <td>
                            <p>
                                {{ experience.street }}<br />
                                {{ experience.city }} {{ experience.state.name }}, {{ experience.zipcode }}
                            </p>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>

        function fallbackCopyTextToClipboard(text) {
            var textArea = document.createElement("textarea");
            textArea.value = text;

            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                var successful = document.execCommand('copy');
                var msg = successful ? 'successful' : 'unsuccessful';
                console.log('Fallback: Copying text command was ' + msg);
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }

            document.body.removeChild(textArea);
        }
        function copyTextToClipboard(text) {
            if (!navigator.clipboard) {
                fallbackCopyTextToClipboard(text);
                return;
            }
            navigator.clipboard.writeText(text).then(function() {
                console.log('Async: Copying to clipboard was successful!');
            }, function(err) {
                console.error('Async: Could not copy text: ', err);
            });
        }


        function copyFeedbackUrl() {
            var feedbackUrl = document.getElementById("feedback-url");
            copyTextToClipboard(feedbackUrl.value);
            window.alert("Url " + feedbackUrl.value + " copied to clipboard.");
        }

    </script>

{% endblock %}
