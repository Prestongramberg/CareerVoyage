{% extends 'baseAuthenticated.html.twig' %}

{% block title %}User Import Tool{% endblock %}
{% block bodyClass %}page-feedback{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('build/user_import.js') }}"></script>
{% endblock %}

{% block body %}

    <div class="uk-container">

        <ul class="uk-breadcrumb">
            <li><a href="{{ path('dashboard') }}">Home</a></li>
            <li><span href="">Import Users</span></li>
        </ul>

        {% if flow.steps[flow.getCurrentStepNumber() - 1].name == 'user_info_step' %}
            {% set errorMessage = '' %}
            {% for flashMessage in app.session.flashbag.get('importError') %}
                {% set errorMessage = flashMessage %}
            {% endfor %}
            {% if errorMessage %}
                <div class="uk-container uk-margin-bottom">
                    <div class="uk-alert-error uk-margin" uk-alert>
                        <p>{{ errorMessage }}</p>
                    </div>
                </div>
            {% endif %}

        {% endif %}

        {% if form.vars.notice is defined and form.vars.notice is not null %}
            <div class="uk-alert-danger" uk-alert>
                <p>{{ form.vars.notice }}</p>
            </div>
        {% endif %}

        {% set uk_width = 'uk-width-3-4@m' %}

        {% if flow.steps[flow.getCurrentStepNumber() - 1].name == 'user_info_step' %}
            {% set uk_width = '' %}
        {% endif %}


        <div class="uk-margin-medium-top uk-card uk-card-default uk-card-body uk-margin-auto {{ uk_width }}">

            <div class="uk-text-danger" style="float:right;">* indicates required</div>

            {% if type %}
                <h2>Import {{ type|capitalize ~ 's'}}</h2>
            {% else %}
                <h2>Import Users</h2>
            {% endif %}

            {{ form_start(form, {attr: {'novalidate' : 'novalidate'}}) }}

            {{ form_errors(form) }}

            {% include flow.steps[flow.getCurrentStepNumber() - 1].template %}

            {{ form_rest(form) }}


            {% if flow.steps[flow.getCurrentStepNumber() - 1].name == 'user_info_step' %}
                {% include '@CraueFormFlow/FormFlow/buttons.html.twig' with {
                    craue_formflow_button_class_reset: 'uk-button uk-button-primary uk-hidden',
                    craue_formflow_button_class_next: 'uk-button uk-button-primary uk-align-right',
                    craue_formflow_button_label_next: 'Continue',
                    craue_formflow_button_class_last: 'uk-button uk-button-primary',
                    craue_formflow_button_class_back: 'uk-button uk-button-primary',
                    craue_formflow_button_class_finish: 'uk-button uk-button-primary uk-align-right uk-hidden',
                    craue_formflow_button_label_finish: 'Submit',
                } %}
            {% else %}
                {% include '@CraueFormFlow/FormFlow/buttons.html.twig' with {
                    craue_formflow_button_class_reset: 'uk-button uk-button-primary uk-hidden',
                    craue_formflow_button_class_next: 'uk-button uk-button-primary uk-align-right',
                    craue_formflow_button_label_next: 'Continue',
                    craue_formflow_button_class_last: 'uk-button uk-button-primary',
                    craue_formflow_button_class_back: 'uk-button uk-button-primary',
                    craue_formflow_button_class_finish: 'uk-button uk-button-primary uk-align-right',
                    craue_formflow_button_label_finish: 'Submit',
                } %}
            {% endif %}

            {{ form_end(form) }}

        </div>

    </div>

{% endblock %}
